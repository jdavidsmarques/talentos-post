<div class="container">
  <h1>Social media post - Talentos Objetivos</h1>

  <!-- Preview Sidebar Toggle Button (visible only on mobile) -->
  <button 
    class="preview-sidebar-toggle"
    (click)="togglePreviewSidebar()"
    [class.active]="showPreviewSidebar"
    title="Toggle Preview"
  >
    <span *ngIf="!showPreviewSidebar">üëÅÔ∏è</span>
    <span *ngIf="showPreviewSidebar">‚úï</span>
  </button>

  <div class="main-layout">
    <div class="form-column">
      <div class="form-section">
        <h2>Race Information</h2>
        <div class="form-grid">
          <div>
            <label>Distance:</label>
            <textarea
              [(ngModel)]="formData.distance"
              placeholder="20K"
              rows="2"
            ></textarea>
          </div>
          <div>
            <label>Race Name:</label>
            <textarea
              [(ngModel)]="formData.raceName"
              placeholder="TRAIL DA PEDRA FERIDA"
              rows="2"
            ></textarea>
          </div>
          <div>
            <label>Date & Location:</label>
            <input
              type="text"
              [(ngModel)]="formData.dateLocation"
              placeholder="16 NOV - PENELA, PORTUGAL"
            />
          </div>
        </div>
      </div>

      <div class="form-section">
        <app-athlete-selector
          [athletes]="athletes"
          [selectedAthletes]="selectedAthleteIds"
          (toggleAthlete)="onToggleAthlete($event)"
        ></app-athlete-selector>
      </div>
    </div>

    <div class="preview-column" [class.sidebar-open]="showPreviewSidebar">
      <div class="preview-section">
        <div class="preview-header">
          <h2>Preview</h2>
          <div class="preview-controls">
            <button
              (click)="openFullPreview()"
              class="full-preview-btn"
              title="View Full Size"
            >
              Full Size
            </button>
            <button
              (click)="onDownload()"
              [disabled]="!canDownload()"
              class="download-btn"
            >
              {{ isGenerating ? 'Generating...' : 'Download' }}
            </button>
          </div>
        </div>
        <div class="preview-container">
          <div #postTemplate>
            <app-post-template 
              [data]="previewData"
              [style.transform]="showPreviewSidebar ? 'scale(1)' : 'scale(0.5)'"
              [style.transform-origin]="'top center'"
              [style.width]="showPreviewSidebar ? '100%' : '1080px'"
            ></app-post-template>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sidebar Overlay (for mobile) -->
  <div 
    class="sidebar-overlay" 
    *ngIf="showPreviewSidebar" 
    (click)="closePreviewSidebar()"
  ></div>

  <!-- Full Preview Overlay -->
  <div class="full-preview-overlay" *ngIf="showFullPreview" (click)="closeFullPreview()">
    <div class="full-preview-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closeFullPreview()" title="Close">√ó</button>
      <app-post-template 
        [data]="previewData"
        class="full-preview-template"
      ></app-post-template>
    </div>
  </div>
</div>

